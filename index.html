<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Snowcheck | @SNOWMAN YT</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <style>
        :root {
            --neon-blue: #00d4ff;
            --pure-white: #ffffff;
            --neon-green: #39ff14;
            --neon-red: #ff3131;
            --bg-dark: #020202;
            --border-blue: rgba(0, 212, 255, 0.4);
        }

        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-dark);
            color: var(--neon-blue);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .main-title {
            font-size: 2rem;
            font-weight: 900;
            letter-spacing: 6px;
            color: #fff;
            text-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue);
            margin: 15px 0 5px 0;
            text-transform: uppercase;
            text-align: center;
        }

        /* NEW: Elimination Broadcast Style */
        #elimination-broadcast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: bold;
            border: 2px solid var(--neon-red);
            box-shadow: 0 0 20px var(--neon-red);
            display: none;
            z-index: 2000;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
            min-width: 300px;
        }

        #check-alert {
            position: fixed;
            top: 80px;
            background: rgba(255, 49, 49, 0.95);
            color: white;
            padding: 8px 25px;
            font-weight: bold;
            border-radius: 50px;
            text-transform: uppercase;
            box-shadow: 0 0 25px var(--neon-red);
            display: none;
            z-index: 1000;
            animation: pulse 0.8s infinite;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.08); } 100% { transform: scale(1); } }

        .player-profile {
            width: 95vw; max-width: 500px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px; margin: 5px 0;
            border: 2px solid var(--neon-blue);
            background: rgba(0, 212, 255, 0.05);
            border-radius: 8px;
        }

        .timer {
            font-family: 'Courier New', monospace; font-size: 1.4rem; font-weight: bold;
            color: #fff; background: #000; padding: 4px 12px;
            border-radius: 4px; border: 1px solid var(--neon-blue);
            transition: 0.3s;
        }

        .active-timer { border-color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green); color: var(--neon-green); }

        .board-wrapper { width: 95vw; max-width: 500px; position: relative; }
        #board { width: 100%; border: 6px solid var(--neon-blue); box-shadow: 0 0 35px rgba(0, 212, 255, 0.5); }

        .square-55d63 { box-sizing: border-box !important; border: 0.5px solid var(--border-blue) !important; }
        .white-1e1d7 { background-color: var(--pure-white) !important; box-shadow: inset 0 0 10px rgba(0, 150, 255, 0.2) !important; }
        .black-3c85d { background-color: var(--neon-blue) !important; box-shadow: inset 0 0 15px rgba(255, 255, 255, 0.4) !important; }

        .highlight-selected { box-shadow: inset 0 0 0 5px yellow !important; }
        .highlight-move { box-shadow: inset 0 0 15px 5px var(--neon-green) !important; background: rgba(57, 255, 20, 0.2) !important; }
        .highlight-capture { box-shadow: inset 0 0 15px 5px var(--neon-red) !important; background: rgba(255, 49, 49, 0.3) !important; }
        .highlight-check { box-shadow: inset 0 0 25px 10px var(--neon-red) !important; }

        .controls { display: flex; gap: 10px; margin: 15px 0; flex-wrap: wrap; justify-content: center;}
        button {
            padding: 10px 18px; background: transparent; border: 2px solid var(--neon-blue);
            color: var(--neon-blue); font-weight: bold; cursor: pointer; text-transform: uppercase; transition: 0.3s;
        }
        button:hover { background: var(--neon-blue); color: #000; box-shadow: 0 0 15px var(--neon-blue); }
        
        .btn-quit { border-color: var(--neon-red); color: var(--neon-red); }
        .btn-quit:hover { background: var(--neon-red); color: #fff; box-shadow: 0 0 15px var(--neon-red); }

        .developer-footer {
            font-size: 0.75rem; letter-spacing: 2px; color: var(--neon-blue);
            margin: 20px 0; text-transform: uppercase; opacity: 0.7;
            border-top: 1px solid var(--border-blue); padding-top: 10px; width: 80%; text-align: center;
        }
    </style>
</head>
<body>

    <div class="main-title">NEON SNOWCHECK</div>
    <div id="check-alert">⚠️ KING IN DANGER ⚠️</div>
    <div id="elimination-broadcast"></div>

    <div class="player-profile">
        <div><strong>SYSTEM AI (BLACK)</strong></div>
        <div class="timer" id="black-timer">02:30</div>
    </div>

    <div class="board-wrapper">
        <div id="board"></div>
    </div>

    <div class="player-profile">
        <div><strong>PLAYER (WHITE)</strong></div>
        <div class="timer" id="white-timer">02:30</div>
    </div>

    <div class="controls">
        <button onclick="setMode('pvp')">PVP</button>
        <button onclick="setMode('pva')">VS AI</button>
        <button onclick="resetGame()">REBOOT</button>
        <button class="btn-quit" onclick="quitGame()">QUIT</button>
    </div>

    <div class="developer-footer">Game developed by @ SNOWMAN YT</div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

    <script>
        var board = null;
        var game = new Chess();
        var mode = 'pva';
        var selectedSquare = null;
        var whiteTime = 150, blackTime = 150;
        var timerInterval = null;

        const pieceNames = { 'p': 'Soldier', 'n': 'Knight', 'b': 'Bishop', 'r': 'Rook', 'q': 'Minister', 'k': 'King' };

        function formatTime(s) {
            let m = Math.floor(s/60); let sec = s%60;
            return (m<10?'0':'')+m+':'+(sec<10?'0':'')+sec;
        }

        function updateTimerDisplay() {
            $('#white-timer').text(formatTime(whiteTime));
            $('#black-timer').text(formatTime(blackTime));
            $('.timer').removeClass('active-timer');
            if (game.turn() === 'w') $('#white-timer').addClass('active-timer');
            else $('#black-timer').addClass('active-timer');
        }

        function resetTimersToInitial() {
            whiteTime = 150;
            blackTime = 150;
            updateTimerDisplay();
        }

        // NEW: Elimination Broadcast Function
        function triggerBroadcast(move) {
            if (move.captured) {
                const attackerColor = move.color === 'w' ? 'WHITE' : 'BLACK';
                const victimColor = move.color === 'w' ? 'BLACK' : 'WHITE';
                const attackerName = pieceNames[move.piece];
                const victimName = pieceNames[move.captured];
                
                const message = `${victimColor} ${victimName} has been eliminated by ${attackerColor} ${attackerName}`;
                
                $('#elimination-broadcast').stop(true, true).text(message).fadeIn(300).delay(3000).fadeOut(500);
            }
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (game.game_over()) {
                    clearInterval(timerInterval);
                    return;
                }
                if (game.turn() === 'w') whiteTime--; 
                else blackTime--; 

                if (whiteTime <= 0 || blackTime <= 0) {
                    clearInterval(timerInterval);
                    alert("TIME EXPIRED! GAME OVER.");
                }
                updateTimerDisplay();
            }, 1000);
        }

        function checkGameState() {
            $('#check-alert').hide();
            $('.square-55d63').removeClass('highlight-check');
            
            if (game.in_check()) {
                $('#check-alert').fadeIn();
                let kingPos = "";
                game.board().forEach((row, r) => {
                    row.forEach((p, c) => {
                        if (p && p.type === 'k' && p.color === game.turn()) 
                            kingPos = String.fromCharCode(97+c) + (8-r);
                    });
                });
                $('.square-' + kingPos).addClass('highlight-check');
            }

            if (game.game_over()) {
                clearInterval(timerInterval);
                let status = "GAME OVER";
                if (game.in_checkmate()) status = "CHECKMATE! " + (game.turn() === 'w' ? "BLACK" : "WHITE") + " WINS.";
                else if (game.in_draw()) status = "DRAW!";
                setTimeout(() => alert(status), 250);
            }
        }

        function onSquareClick(square) {
            if (game.game_over()) return;
            var piece = game.get(square);

            if (selectedSquare === null) {
                if (piece && piece.color === game.turn()) {
                    selectedSquare = square;
                    showProjections(square);
                }
            } else {
                var move = game.move({ from: selectedSquare, to: square, promotion: 'p' }); 
                
                if (move === null) {
                    move = game.move({ from: selectedSquare, to: square, promotion: 'q' });
                    if (move && move.flags.includes('p')) {
                        let fen = game.fen().replace(/Q(?=[^ ]* b)/, 'P').replace(/q(?=[^ ]* w)/, 'p');
                        game.load(fen);
                    }
                }

                if (move === null) {
                    if (piece && piece.color === game.turn()) {
                        selectedSquare = square;
                        showProjections(square);
                    } else {
                        selectedSquare = null;
                        removeHighlights();
                    }
                } else {
                    // Trigger broadcast for player move
                    triggerBroadcast(move);
                    board.position(game.fen());
                    selectedSquare = null;
                    removeHighlights();
                    checkGameState();
                    
                    whiteTime = 150;
                    blackTime = 150;
                    updateTimerDisplay();

                    if (!timerInterval) startTimer();

                    if (mode === 'pva' && !game.game_over()) {
                        window.setTimeout(makeRandomMove, 600);
                    }
                }
            }
        }

        function makeRandomMove() {
            if (game.game_over()) return; 
            var moves = game.moves({verbose: true});
            if (moves.length === 0) return;
            
            let moveData = moves[Math.floor(Math.random() * moves.length)];
            let move = game.move(moveData);
            
            if (move && move.flags.includes('p')) {
                let fen = game.fen().replace(/Q(?=[^ ]* b)/, 'P').replace(/q(?=[^ ]* w)/, 'p');
                game.load(fen);
            }

            // Trigger broadcast for AI move
            triggerBroadcast(move);
            board.position(game.fen());
            
            whiteTime = 150;
            blackTime = 150;
            updateTimerDisplay();
            checkGameState();
        }

        function showProjections(square) {
            removeHighlights();
            $('#board .square-' + square).addClass('highlight-selected');
            game.moves({ square: square, verbose: true }).forEach(m => {
                let type = (m.flags.includes('c') || m.flags.includes('e')) ? 'capture' : 'move';
                $('#board .square-' + m.to).addClass('highlight-' + type);
            });
        }

        function removeHighlights() { $('.square-55d63').removeClass('highlight-move highlight-capture highlight-selected highlight-check'); }

        function resetGame() {
            clearInterval(timerInterval); timerInterval = null;
            resetTimersToInitial();
            game.reset(); 
            board.start();
            removeHighlights(); 
            $('#check-alert').hide();
            $('#elimination-broadcast').hide();
        }

        function quitGame() {
            if(confirm("Are you sure you want to quit the current game?")) {
                resetGame();
            }
        }

        board = Chessboard('board', {
            position: 'start', draggable: false, moveSpeed: 450, showNotation: true,
            pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
        });

        $(document).on('click', '.square-55d63', function() { onSquareClick($(this).attr('data-square')); });
        $(window).resize(board.resize);
        updateTimerDisplay();
        function setMode(m) { mode = m; resetGame(); }
    </script>
</body>
</html>